(self.webpackChunkbeancount_web=self.webpackChunkbeancount_web||[]).push([[262],{8262:function(e,t,n){"use strict";n.r(t);var a=n(5671),r=n(3144),o=n(136),i=n(8557),c=n(3709),s=n(9491),l=n(2008),u=n(3084),d=n(3655),f=n(6345),m=n(2652),p=n(9888),h=n(7313),v=n(870),y=n(9277),Z=n(5789),g=n(6417),x={required:"${label} \u4e0d\u80fd\u4e3a\u7a7a\uff01"},b=function(e){(0,o.Z)(n,e);var t=(0,i.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).formRef=h.createRef(),e.state={loading:!1,checkStatus:"loading",showForm:!1,config:{}},e.checkReq=function(){e.setState({loading:!0}),(0,v.he)("/api/check",{method:"POST"}).then((function(t){e.setState({checkStatus:"ok"})})).catch((function(){e.setState({checkStatus:"error"})})).finally((function(){e.setState({loading:!1})}))},e.handleNextStep=function(){e.setState({loading:!0}),(0,v.he)("/api/config",{method:"GET"}).then((function(t){e.setState({config:t,showForm:!0})})).finally((function(){e.setState({loading:!1})}))},e.handleReCheck=function(){e.checkReq()},e.handleSubmitServerConfig=function(t){e.setState({loading:!0}),(0,v.he)("/api/config",{method:"POST",body:t}).then((function(){e.props.history.replace("/ledger")})).finally((function(){e.setState({loading:!1})}))},e}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){this.checkReq()}},{key:"render",value:function(){return"error"===this.state.checkStatus?(0,g.jsxs)("div",{children:[(0,g.jsx)(c.Z,{message:"\u68c0\u6d4b\u5931\u8d25",description:"\u4f9d\u8d56\u672a\u5b89\u88c5\uff0c\u8bf7\u5148\u5b89\u88c5 beancount",type:"error",showIcon:!0}),(0,g.jsx)("div",{style:{marginTop:"1rem"},children:(0,g.jsx)(s.Z,{block:!0,type:"danger",loading:this.state.loading,onClick:this.handleReCheck,children:"\u91cd\u65b0\u68c0\u6d4b"})}),(0,g.jsx)("div",{style:{marginTop:"1rem"},children:(0,g.jsx)("a",{href:"https://www.yuque.com/chuyi-ble7p/beancount-ns/sqwwqa#RwqnF",target:"_blank",children:"\u600e\u4e48\u5b89\u88c5 beancount ?"})})]}):"ok"===this.state.checkStatus?this.state.showForm?(0,g.jsx)("div",{children:(0,g.jsxs)(l.Z,{name:"init-form",className:"page-form",size:"middle",layout:"vertical",style:{textAlign:"left"},ref:this.formRef,onFinish:this.handleSubmitServerConfig,validateMessages:x,children:[(0,g.jsx)(l.Z.Item,{label:(0,g.jsxs)(h.Fragment,{children:[(0,g.jsx)("span",{children:"\u8d26\u672c\u5b58\u50a8\u4f4d\u7f6e"}),"\xa0",(0,g.jsx)(u.Z,{title:"\u5982\u679c\u662fdocker\u5bb9\u5668\u90e8\u7f72\uff0c\u6b64\u5904\u9ed8\u8ba4\u4e3a\uff1a/data/beancount",children:(0,g.jsx)(p.Z,{})})]}),name:"dataPath",initialValue:this.state.config.dataPath,rules:[{required:!0}],children:(0,g.jsx)(d.Z,{placeholder:"\u8d26\u672c\u5b58\u50a8\u4f4d\u7f6e"})}),(0,g.jsx)(l.Z.Item,{label:"\u8d26\u672c\u5f00\u59cb\u65e5\u671f",name:"startDate",initialValue:this.state.config.startDate,rules:[{required:!0}],children:(0,g.jsx)(d.Z,{type:"date",placeholder:"\u8d26\u672c\u5f00\u59cb\u65e5\u671f"})}),(0,g.jsx)(l.Z.Item,{label:"\u5e01\u79cd",name:"operatingCurrency",initialValue:this.state.config.operatingCurrency,rules:[{required:!0}],children:(0,g.jsx)(d.Z,{placeholder:"\u5e01\u79cd"})}),(0,g.jsx)(l.Z.Item,{label:"\u5e73\u8861\u8d26\u6237\u540d\u79f0\u8bbe\u7f6e",name:"openingBalances",initialValue:this.state.config.openingBalances,rules:[{required:!0}],children:(0,g.jsx)(d.Z,{placeholder:"\u5e73\u8861\u8d26\u6237\u540d\u79f0\u8bbe\u7f6e"})}),(0,g.jsx)(l.Z.Item,{label:"\u4fee\u6539\u6e90\u6587\u4ef6\u65f6\u662f\u5426\u5907\u4efd\u6570\u636e",name:"isBak",valuePropName:"checked",initialValue:this.state.config.isBak,children:(0,g.jsx)(f.Z,{})}),(0,g.jsx)(l.Z.Item,{label:(0,g.jsxs)(h.Fragment,{children:[(0,g.jsx)("span",{children:"\u5bc6\u94a5"}),"\xa0",(0,g.jsx)(u.Z,{title:"\u53ef\u4ee5\u5728\u542f\u52a8\u65e5\u5fd7\u4e2d\u67e5\u770b",children:(0,g.jsx)(p.Z,{})})]}),name:"secret",rules:[{required:!0}],children:(0,g.jsx)(d.Z.Password,{placeholder:"\u5bc6\u94a5"})}),(0,g.jsx)(l.Z.Item,{children:(0,g.jsx)(s.Z,{block:!0,type:"primary",htmlType:"submit",loading:this.state.loading,className:"submit-button",children:"\u786e\u8ba4"})})]})}):(0,g.jsxs)("div",{children:[(0,g.jsx)(c.Z,{message:"\u68c0\u6d4b\u901a\u8fc7",description:"beancount\u5df2\u5b89\u88c5\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\u6765\u5b8c\u6210\u521d\u59cb\u914d\u7f6e",type:"success",showIcon:!0}),(0,g.jsx)("div",{style:{marginTop:"1rem"}}),(0,g.jsx)(s.Z,{type:"primary",block:!0,onClick:this.handleNextStep,children:"\u4e0b\u4e00\u6b65"})]}):(0,g.jsx)(m.Z,{tip:"Loading...",children:(0,g.jsx)(c.Z,{message:"\u68c0\u6d4b\u4e2d",description:"\u6b63\u5728\u68c0\u6d4b beancount \u662f\u5426\u5df2\u5b89\u88c5",type:"info",showIcon:!0})})}}]),n}(h.Component);b.contextType=y.Z,t.default=(0,Z.Z)(b)},5789:function(e,t,n){"use strict";var a=n(1413),r=n(5671),o=n(3144),i=n(136),c=n(8557),s=n(7313),l=n(6417);t.Z=function(e){return function(t){(0,i.Z)(s,t);var n=(0,c.Z)(s);function s(){var e;(0,r.Z)(this,s);for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return(e=n.call.apply(n,[this].concat(a))).defaultCommodity={currency:"CNY",symbol:"\uffe5"},e.currentCommodity=window.localStorage.getItem("ledgerCurrency"),e}return(0,o.Z)(s,[{key:"render",value:function(){return(0,l.jsx)(e,(0,a.Z)((0,a.Z)({},this.props),{},{commodity:this.currentCommodity?JSON.parse(this.currentCommodity):this.defaultCommodity}))}}]),s}(s.Component)}},1176:function(e,t,n){"use strict";function a(e){return Object.keys(e).reduce((function(t,n){return!n.startsWith("data-")&&!n.startsWith("aria-")&&"role"!==n||n.startsWith("data-__")||(t[n]=e[n]),t}),{})}n.d(t,{Z:function(){return a}})},3709:function(e,t,n){"use strict";n.d(t,{Z:function(){return R}});var a=n(7462),r=n(9439),o=n(4942),i=n(9649),c=n(6430),s=n(8315),l=n(5049),u=n(1829),d=n(8925),f=n(3598),m=n(5403),p=n(9959),h=n(6123),v=n.n(h),y=n(5266),Z=n(7313),g=n(4714),x=n(1176),b=n(8138),C=n(5671),N=n(3144),k=n(136),w=n(8557),j=function(e){(0,k.Z)(n,e);var t=(0,w.Z)(n);function n(){var e;return(0,C.Z)(this,n),(e=t.apply(this,arguments)).state={error:void 0,info:{componentStack:""}},e}return(0,N.Z)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,info:t})}},{key:"render",value:function(){var e=this.props,t=e.message,n=e.description,a=e.children,r=this.state,o=r.error,i=r.info,c=i&&i.componentStack?i.componentStack:null,s="undefined"===typeof t?(o||"").toString():t,l="undefined"===typeof n?c:n;return o?Z.createElement(R,{type:"error",message:s,description:Z.createElement("pre",null,l)}):a}}]),n}(Z.Component),E=j,S=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},O={success:i.Z,info:m.Z,error:s.Z,warning:d.Z},I={success:c.Z,info:p.Z,error:l.Z,warning:f.Z},T=function(e){var t=e.description,n=e.icon,a=e.prefixCls,r=e.type,i=(t?I:O)[r]||null;return n?(0,b.wm)(n,Z.createElement("span",{className:"".concat(a,"-icon")},n),(function(){return{className:v()("".concat(a,"-icon"),(0,o.Z)({},n.props.className,n.props.className))}})):Z.createElement(i,{className:"".concat(a,"-icon")})},P=function(e){var t=e.isClosable,n=e.closeText,a=e.prefixCls,r=e.closeIcon,o=e.handleClose;return t?Z.createElement("button",{type:"button",onClick:o,className:"".concat(a,"-close-icon"),tabIndex:0},n?Z.createElement("span",{className:"".concat(a,"-close-text")},n):r):null},q=function(e){var t,n=e.description,i=e.prefixCls,c=e.message,s=e.banner,l=e.className,d=void 0===l?"":l,f=e.style,m=e.onMouseEnter,p=e.onMouseLeave,h=e.onClick,b=e.afterClose,C=e.showIcon,N=e.closable,k=e.closeText,w=e.closeIcon,j=void 0===w?Z.createElement(u.Z,null):w,E=e.action,O=S(e,["description","prefixCls","message","banner","className","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action"]),I=Z.useState(!1),q=(0,r.Z)(I,2),R=q[0],_=q[1],M=Z.useRef(),D=Z.useContext(g.E_),F=D.getPrefixCls,L=D.direction,A=F("alert",i),V=function(e){var t;_(!0),null===(t=O.onClose)||void 0===t||t.call(O,e)},W=!!k||N,$=function(){var e=O.type;return void 0!==e?e:s?"warning":"info"}(),z=!(!s||void 0!==C)||C,B=v()(A,"".concat(A,"-").concat($),(t={},(0,o.Z)(t,"".concat(A,"-with-description"),!!n),(0,o.Z)(t,"".concat(A,"-no-icon"),!z),(0,o.Z)(t,"".concat(A,"-banner"),!!s),(0,o.Z)(t,"".concat(A,"-rtl"),"rtl"===L),t),d),H=(0,x.Z)(O);return Z.createElement(y.ZP,{visible:!R,motionName:"".concat(A,"-motion"),motionAppear:!1,motionEnter:!1,onLeaveStart:function(e){return{maxHeight:e.offsetHeight}},onLeaveEnd:b},(function(e){var t=e.className,r=e.style;return Z.createElement("div",(0,a.Z)({ref:M,"data-show":!R,className:v()(B,t),style:(0,a.Z)((0,a.Z)({},f),r),onMouseEnter:m,onMouseLeave:p,onClick:h,role:"alert"},H),z?Z.createElement(T,{description:n,icon:O.icon,prefixCls:A,type:$}):null,Z.createElement("div",{className:"".concat(A,"-content")},c?Z.createElement("div",{className:"".concat(A,"-message")},c):null,n?Z.createElement("div",{className:"".concat(A,"-description")},n):null),E?Z.createElement("div",{className:"".concat(A,"-action")},E):null,Z.createElement(P,{isClosable:!!W,closeText:k,prefixCls:A,closeIcon:j,handleClose:V}))}))};q.ErrorBoundary=E;var R=q},2652:function(e,t,n){"use strict";var a=n(7462),r=n(4942),o=n(9439),i=n(6123),c=n.n(i),s=n(2279),l=n.n(s),u=n(205),d=n(7313),f=n(4714),m=n(8138),p=n(6927),h=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},v=((0,p.b)("small","default","large"),null);var y=function(e){var t=e.spinPrefixCls,n=e.spinning,i=void 0===n||n,s=e.delay,p=e.className,y=e.size,Z=void 0===y?"default":y,g=e.tip,x=e.wrapperClassName,b=e.style,C=e.children,N=h(e,["spinPrefixCls","spinning","delay","className","size","tip","wrapperClassName","style","children"]),k=d.useState((function(){return i&&!function(e,t){return!!e&&!!t&&!isNaN(Number(t))}(i,s)})),w=(0,o.Z)(k,2),j=w[0],E=w[1];d.useEffect((function(){var e=l()((function(){E(i)}),s);return e(),function(){var t;null===(t=null===e||void 0===e?void 0:e.cancel)||void 0===t||t.call(e)}}),[s,i]);var S=function(n){var o,i=n.direction,s=c()(t,(o={},(0,r.Z)(o,"".concat(t,"-sm"),"small"===Z),(0,r.Z)(o,"".concat(t,"-lg"),"large"===Z),(0,r.Z)(o,"".concat(t,"-spinning"),j),(0,r.Z)(o,"".concat(t,"-show-text"),!!g),(0,r.Z)(o,"".concat(t,"-rtl"),"rtl"===i),o),p),l=(0,u.Z)(N,["indicator","prefixCls"]),f=d.createElement("div",(0,a.Z)({},l,{style:b,className:s,"aria-live":"polite","aria-busy":j}),function(e,t){var n=t.indicator,a="".concat(e,"-dot");return null===n?null:(0,m.l$)(n)?(0,m.Tm)(n,{className:c()(n.props.className,a)}):(0,m.l$)(v)?(0,m.Tm)(v,{className:c()(v.props.className,a)}):d.createElement("span",{className:c()(a,"".concat(e,"-dot-spin"))},d.createElement("i",{className:"".concat(e,"-dot-item")}),d.createElement("i",{className:"".concat(e,"-dot-item")}),d.createElement("i",{className:"".concat(e,"-dot-item")}),d.createElement("i",{className:"".concat(e,"-dot-item")}))}(t,e),g?d.createElement("div",{className:"".concat(t,"-text")},g):null);if("undefined"!==typeof C){var h=c()("".concat(t,"-container"),(0,r.Z)({},"".concat(t,"-blur"),j));return d.createElement("div",(0,a.Z)({},l,{className:c()("".concat(t,"-nested-loading"),x)}),j&&d.createElement("div",{key:"loading"},f),d.createElement("div",{className:h,key:"container"},C))}return f};return d.createElement(f.C,null,S)},Z=function(e){var t=e.prefixCls,n=(0,d.useContext(f.E_).getPrefixCls)("spin",t),r=(0,a.Z)((0,a.Z)({},e),{spinPrefixCls:n});return d.createElement(y,(0,a.Z)({},r))};Z.setDefaultIndicator=function(e){v=e},t.Z=Z},6345:function(e,t,n){"use strict";n.d(t,{Z:function(){return b}});var a=n(7462),r=n(4942),o=n(2508),i=n(6123),c=n.n(i),s=n(9439),l=n(5987),u=n(7313),d=n(288),f=n(9242),m=u.forwardRef((function(e,t){var n,a=e.prefixCls,o=void 0===a?"rc-switch":a,i=e.className,m=e.checked,p=e.defaultChecked,h=e.disabled,v=e.loadingIcon,y=e.checkedChildren,Z=e.unCheckedChildren,g=e.onClick,x=e.onChange,b=e.onKeyDown,C=(0,l.Z)(e,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),N=(0,d.Z)(!1,{value:m,defaultValue:p}),k=(0,s.Z)(N,2),w=k[0],j=k[1];function E(e,t){var n=w;return h||(j(n=e),null===x||void 0===x||x(n,t)),n}var S=c()(o,i,(n={},(0,r.Z)(n,"".concat(o,"-checked"),w),(0,r.Z)(n,"".concat(o,"-disabled"),h),n));return u.createElement("button",Object.assign({},C,{type:"button",role:"switch","aria-checked":w,disabled:h,className:S,ref:t,onKeyDown:function(e){e.which===f.Z.LEFT?E(!1,e):e.which===f.Z.RIGHT&&E(!0,e),null===b||void 0===b||b(e)},onClick:function(e){var t=E(!w,e);null===g||void 0===g||g(t,e)}}),v,u.createElement("span",{className:"".concat(o,"-inner")},w?y:Z))}));m.displayName="Switch";var p=m,h=n(4714),v=n(8438),y=n(1631),Z=n(6479),g=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},x=u.forwardRef((function(e,t){var n,i=e.prefixCls,s=e.size,l=e.disabled,d=e.loading,f=e.className,m=void 0===f?"":f,x=g(e,["prefixCls","size","disabled","loading","className"]),b=u.useContext(h.E_),C=b.getPrefixCls,N=b.direction,k=u.useContext(y.Z),w=u.useContext(v.Z),j=(null!==l&&void 0!==l?l:w)||d,E=C("switch",i),S=u.createElement("div",{className:"".concat(E,"-handle")},d&&u.createElement(o.Z,{className:"".concat(E,"-loading-icon")})),O=c()((n={},(0,r.Z)(n,"".concat(E,"-small"),"small"===(s||k)),(0,r.Z)(n,"".concat(E,"-loading"),d),(0,r.Z)(n,"".concat(E,"-rtl"),"rtl"===N),n),m);return u.createElement(Z.Z,{insertExtraNode:!0},u.createElement(p,(0,a.Z)({},x,{prefixCls:E,className:O,disabled:j,ref:t,loadingIcon:S})))}));x.__ANT_SWITCH=!0;var b=x},2306:function(e,t,n){var a=n(5510),r=/^\s+/;e.exports=function(e){return e?e.slice(0,a(e)+1).replace(r,""):e}},5510:function(e){var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},2279:function(e,t,n){var a=n(1845),r=n(6170),o=n(7923),i=Math.max,c=Math.min;e.exports=function(e,t,n){var s,l,u,d,f,m,p=0,h=!1,v=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function Z(t){var n=s,a=l;return s=l=void 0,p=t,d=e.apply(a,n)}function g(e){var n=e-m;return void 0===m||n>=t||n<0||v&&e-p>=u}function x(){var e=r();if(g(e))return b(e);f=setTimeout(x,function(e){var n=t-(e-m);return v?c(n,u-(e-p)):n}(e))}function b(e){return f=void 0,y&&s?Z(e):(s=l=void 0,d)}function C(){var e=r(),n=g(e);if(s=arguments,l=this,m=e,n){if(void 0===f)return function(e){return p=e,f=setTimeout(x,t),h?Z(e):d}(m);if(v)return clearTimeout(f),f=setTimeout(x,t),Z(m)}return void 0===f&&(f=setTimeout(x,t)),d}return t=o(t)||0,a(n)&&(h=!!n.leading,u=(v="maxWait"in n)?i(o(n.maxWait)||0,t):u,y="trailing"in n?!!n.trailing:y),C.cancel=function(){void 0!==f&&clearTimeout(f),p=0,s=m=l=f=void 0},C.flush=function(){return void 0===f?d:b(r())},C}},1845:function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},6170:function(e,t,n){var a=n(7289);e.exports=function(){return a.Date.now()}},7923:function(e,t,n){var a=n(2306),r=n(1845),o=n(2060),i=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=a(e);var n=c.test(e);return n||s.test(e)?l(e.slice(2),n?2:8):i.test(e)?NaN:+e}}}]);