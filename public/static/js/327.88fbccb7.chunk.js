"use strict";(self.webpackChunkbeancount_web=self.webpackChunkbeancount_web||[]).push([[327],{4061:function(t,e,n){n.r(e);var i=n(5671),a=n(3144),o=n(136),r=n(8557),c=n(2350),s=n(5291),h=n(2092),l=n(9491),d=n(2500),u=(n(9390),n(7313)),f=n(870),p=n(9277),m=n(5789),C=n(6417),y=function(t){(0,o.Z)(n,t);var e=(0,r.Z)(n);function n(){var t;(0,i.Z)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))).theme=t.context.theme,t.state={loading:!1,path:null,files:[],rawContent:"",content:"",editorState:d.EditorState.createEmpty()},t.fetchFileDir=function(){t.setState({loading:!0}),(0,f.he)("/api/auth/file/dir").then((function(e){t.setState({files:e})})).finally((function(){t.setState({loading:!1})}))},t.handldEditContent=function(e){t.setState({editorState:e,content:e.getCurrentContent().getPlainText()})},t.handleChangeFile=function(e){t.setState({path:e},(function(){t.fetchFileContent(e)}))},t.fetchFileContent=function(){t.setState({loading:!0}),(0,f.he)("/api/auth/file/content?path=".concat(t.state.path)).then((function(e){t.setState({rawContent:e,content:e,editorState:d.EditorState.createWithContent(d.ContentState.createFromText(e))})})).finally((function(){t.setState({loading:!1})}))},t.saveFileContent=function(){var e=t.state,n=e.path,i=e.content;t.setState({loading:!0}),(0,f.he)("/api/auth/file",{method:"POST",body:{path:n,content:i}}).then((function(){t.setState({rawContent:i}),s.ZP.success("\u4fdd\u5b58\u6210\u529f")})).finally((function(){t.setState({loading:!1})}))},t}return(0,a.Z)(n,[{key:"componentDidMount",value:function(){this.fetchFileDir()}},{key:"render",value:function(){return this.context.theme!==this.theme&&(this.theme=this.context.theme),(0,C.jsxs)("div",{className:"edit-page",children:[(0,C.jsxs)("div",{children:[(0,C.jsx)(h.Z,{showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u6e90\u6587\u4ef6",style:{width:"200px"},onChange:this.handleChangeFile,children:this.state.files.map((function(t){return(0,C.jsx)(h.Z.Option,{value:t,children:t},t)}))}),"\xa0\xa0",(0,C.jsx)(l.Z,{type:"primary",icon:(0,C.jsx)(c.Z,{}),disabled:this.state.rawContent===this.state.content||!this.state.path,loading:this.state.loading,onClick:this.saveFileContent,children:"\u4fdd\u5b58"})]}),(0,C.jsx)("div",{style:{marginTop:"1rem"},children:(0,C.jsx)(d.Editor,{placeholder:this.state.path?"\u8be5\u6587\u4ef6\u5185\u5bb9\u4e3a\u7a7a":"\u672a\u9009\u62e9\u6e90\u6587\u4ef6",editorState:this.state.editorState,onChange:this.handldEditContent})})]})}}]),n}(u.Component);y.contextType=p.Z,e.default=(0,m.Z)(y)},5789:function(t,e,n){var i=n(1413),a=n(5671),o=n(3144),r=n(136),c=n(8557),s=n(7313),h=n(6417);e.Z=function(t){return function(e){(0,r.Z)(s,e);var n=(0,c.Z)(s);function s(){var t;(0,a.Z)(this,s);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(t=n.call.apply(n,[this].concat(i))).defaultCommodity={currency:"CNY",symbol:"\uffe5"},t.currentCommodity=window.localStorage.getItem("ledgerCurrency"),t}return(0,o.Z)(s,[{key:"render",value:function(){return(0,h.jsx)(t,(0,i.Z)((0,i.Z)({},this.props),{},{commodity:this.currentCommodity?JSON.parse(this.currentCommodity):this.defaultCommodity}))}}]),s}(s.Component)}}}]);